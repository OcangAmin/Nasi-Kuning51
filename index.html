<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Kasir Nasi Kuning 51</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
*{box-sizing:border-box}
body{
    margin:0;
    font-family:system-ui,sans-serif;
    background:#eef1f4;
    padding:10px;
}
.app{
    max-width:430px;
    margin:auto;
    background:#fff;
    border-radius:16px;
    padding:14px;
    box-shadow:0 8px 20px rgba(0,0,0,.08);
}
.header{text-align:center;margin-bottom:10px}
.header h1{margin:0;font-size:22px}
.header small{color:#666}

.card{
    background:#fafafa;
    border-radius:12px;
    padding:10px;
    margin-bottom:10px;
}

.menu-grid{
    display:grid;
    grid-template-columns:repeat(2,1fr);
    gap:8px;
}
.menu-btn{
    background:#0d6efd;
    color:#fff;
    border:none;
    border-radius:10px;
    padding:12px 8px;
    font-weight:600;
    cursor:pointer;
}
.menu-btn small{
    display:block;
    font-size:12px;
    opacity:.9;
}

table{
    width:100%;
    border-collapse:collapse;
    font-size:13px;
    table-layout:fixed;
}
th,td{
    padding:6px 4px;
    border-bottom:1px solid #eee;
    text-align:center;
    white-space:nowrap;
    overflow:hidden;
    text-overflow:ellipsis;
}
th{color:#777}
td.menu{text-align:left}
td.qty{width:36px}
td.sub{width:70px}

.delete{
    background:#dc3545;
    color:#fff;
    border:none;
    border-radius:6px;
    padding:4px 6px;
    font-size:12px;
    cursor:pointer;
}

.info{
    display:flex;
    justify-content:space-between;
    font-size:16px;
    font-weight:700;
    margin-top:6px;
}
.kembali{color:#198754}

.row{display:flex;gap:6px;margin-bottom:6px}
input,button{
    padding:10px;
    border-radius:10px;
    border:1px solid #ddd;
    font-size:14px;
}
button{border:none;font-weight:600;cursor:pointer}
.cash{background:#198754;color:#fff;flex:1}
.qris{background:#6f42c1;color:#fff;flex:1}
.save{background:#fd7e14;color:#fff;width:100%}

.metode{text-align:center;font-weight:600;margin-top:4px}
</style>
</head>

<body>
<div class="app">

<div class="header">
    <h1>üçö Nasi Kuning 51</h1>
    <small>Kasir Manual</small>
</div>

<!-- MENU BUTTON -->
<div class="card">
<div class="menu-grid">
<button class="menu-btn" onclick="addItem('Ikan',5000)">Ikan<small>5.000</small></button>
<button class="menu-btn" onclick="addItem('Bakwan',2000)">Bakwan<small>2.000</small></button>
<button class="menu-btn" onclick="addItem('Nasi',5000)">Nasi<small>5.000</small></button>
<button class="menu-btn" onclick="addItem('Telur',5000)">Telur<small>5.000</small></button>
<button class="menu-btn" onclick="addItem('Ayam',5000)">Ayam<small>5.000</small></button>
<button class="menu-btn" onclick="addItem('NK Ayam',15000)">NK Ayam<small>15.000</small></button>
<button class="menu-btn" onclick="addItem('NK Ikan',13000)">NK Ikan<small>13.000</small></button>
<button class="menu-btn" onclick="addItem('NK Telur',10000)">NK Telur<small>10.000</small></button>
<button class="menu-btn" onclick="addItem('NK Ayam Telur',23000)">NK Ayam Telur<small>23.000</small></button>
<button class="menu-btn" onclick="addItem('NK Ikan Telur',20000)">NK Ikan Telur<small>20.000</small></button>
<button class="menu-btn" onclick="addItem('Air Mineral',5000)">Air Mineral<small>5.000</small></button>
</div>
</div>

<!-- CART -->
<div class="card">
<table>
<thead>
<tr>
<th>Menu</th>
<th>Qty</th>
<th>Sub</th>
<th></th>
</tr>
</thead>
<tbody id="cart"></tbody>
</table>

<div class="info">
<span>Total</span>
<span>Rp <span id="total">0</span></span>
</div>
</div>

<!-- PAYMENT -->
<div class="card">
<div class="row">
<button class="cash" onclick="setMetode('CASH')">üíµ CASH</button>
<button class="qris" onclick="setMetode('QRIS')">üì± QRIS</button>
</div>

<input type="number" id="bayar" placeholder="Uang Bayar" oninput="hitungKembali()">

<div class="info kembali">
<span>Kembalian</span>
<span>Rp <span id="kembali">0</span></span>
</div>

<div class="metode">Metode: <span id="metode">-</span></div>

<button class="save" onclick="simpan()">üíæ Save Transaksi</button>
</div>

</div>

<script>
let total = 0;
let metode = "";
const cart = document.getElementById("cart");
const totalEl = document.getElementById("total");
const kembaliEl = document.getElementById("kembali");
const metodeEl = document.getElementById("metode");
const bayarEl = document.getElementById("bayar");

function addItem(nama, harga){
    let row = [...cart.rows].find(r => r.dataset.nama === nama);

    if(row){
        let qty = ++row.dataset.qty;
        let sub = qty * harga;
        row.children[1].innerText = qty;
        row.children[2].innerText = sub;
    }else{
        const tr = document.createElement("tr");
        tr.dataset.nama = nama;
        tr.dataset.qty = 1;
        tr.dataset.harga = harga;
        tr.innerHTML = `
            <td class="menu">${nama}</td>
            <td class="qty">1</td>
            <td class="sub">${harga}</td>
            <td><button class="delete" onclick="hapus(this)">‚úï</button></td>
        `;
        cart.appendChild(tr);
    }
    total += harga;
    update();
}

function hapus(btn){
    const tr = btn.closest("tr");
    const harga = +tr.dataset.harga;
    const qty = +tr.dataset.qty;
    total -= harga * qty;
    tr.remove();
    update();
}

function update(){
    totalEl.innerText = total;
    hitungKembali();
}

function setMetode(m){
    metode = m;
    metodeEl.innerText = m;
    if(m === "QRIS"){
        bayarEl.value = total;
        bayarEl.disabled = true;
    }else{
        bayarEl.disabled = false;
        bayarEl.value = "";
    }
    hitungKembali();
}

function hitungKembali(){
    const b = +bayarEl.value || 0;
    kembaliEl.innerText = b > total ? b - total : 0;
}

function simpan(){
    if(total === 0) return alert("Belum ada transaksi");
    if(!metode) return alert("Pilih metode pembayaran");
    if(metode === "CASH" && bayarEl.value < total) return alert("Uang kurang");

    const now = new Date();
    const t = now.toLocaleDateString("id-ID");
    const j = now.toLocaleTimeString("id-ID");

    const file = `kasir-nasi-kuning-51-${now.toISOString().slice(0,10)}.csv`;
    let csv = localStorage.getItem(file) || "Tanggal,Waktu,Metode,Total\n";
    csv += `${t},${j},${metode},${total}\n`;
    localStorage.setItem(file, csv);

    const a = document.createElement("a");
    a.href = URL.createObjectURL(new Blob([csv],{type:"text/csv"}));
    a.download = file;
    a.click();

    reset();
}

function reset(){
    cart.innerHTML = "";
    total = 0;
    totalEl.innerText = 0;
    bayarEl.value = "";
    kembaliEl.innerText = 0;
    metodeEl.innerText = "-";
    metode = "";
}
</script>

</body>
</html>
