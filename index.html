<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<title>POS Kasir Nasi Kuning 51</title>

<style>
:root{
  --bg:#F4F6F7;
  --card:#FFFFFF;
  --text:#1F2A3A;
  --muted:#6B7785;
  --accent:#1F7A8C;
  --danger:#D9534F;
  --border:rgba(31,42,58,0.12);
}
*{box-sizing:border-box;}
body{
  margin:0;
  font-family:Arial, sans-serif;
  background:var(--bg);
  color:var(--text);
}
.container{
  max-width:420px;
  margin:0 auto;
  padding:10px 10px 100px;
}
.header{
  display:flex;
  justify-content:space-between;
  align-items:center;
}
.tabs{display:flex;gap:8px;}
.tab{
  padding:10px;
  border-radius:12px;
  background:#fff;
  border:1px solid var(--border);
  cursor:pointer;
  font-weight:700;
}
.tab.active{
  background:var(--accent);
  color:#fff;
}
.card{
  background:#fff;
  border-radius:14px;
  border:1px solid var(--border);
  padding:10px;
  margin-top:10px;
}
.grid{
  display:grid;
  grid-template-columns:repeat(2,1fr);
  gap:8px;
  margin-top:10px;
}
.menu-btn{
  padding:12px;
  border-radius:14px;
  border:1px solid var(--border);
  background:#f0f3f4;
  font-weight:800;
  cursor:pointer;
}
.cart-item{
  display:flex;
  justify-content:space-between;
  margin-bottom:8px;
  border-bottom:1px solid var(--border);
  padding-bottom:6px;
}
.qty-btn{
  padding:4px 8px;
  border-radius:10px;
  border:1px solid var(--border);
  cursor:pointer;
  font-weight:800;
}
.total{
  display:flex;
  justify-content:space-between;
  font-weight:900;
  margin-top:8px;
}
.payment-row{
  display:flex;
  gap:8px;
  margin-top:10px;
}
.pay-btn{
  flex:1;
  padding:12px;
  border-radius:12px;
  border:1px solid var(--border);
  cursor:pointer;
  font-weight:900;
}
.pay-btn.active{
  background:var(--accent);
  color:#fff;
}
input{
  width:100%;
  padding:12px;
  border-radius:12px;
  border:1px solid var(--border);
  margin-top:10px;
  font-weight:900;
}
.footer{
  position:fixed;
  bottom:0;
  left:0;
  right:0;
  padding:10px;
  background:#fff;
  border-top:1px solid var(--border);
  display:flex;
  gap:8px;
}
.footer button{
  flex:1;
  padding:14px;
  border-radius:14px;
  border:none;
  font-weight:900;
  cursor:pointer;
}
.btn-main{background:var(--accent);color:#fff;}
.btn-danger{background:var(--danger);color:#fff;}
.hide{display:none;}
</style>
</head>
<body>

<div class="container">

<div class="header">
  <div class="tabs">
    <div class="tab active" onclick="showTab('trans')" id="tabTrans">Transaksi</div>
    <div class="tab" onclick="showTab('hist')" id="tabHist">History</div>
  </div>
  <div style="font-weight:900;">NASI KUNING 51</div>
</div>

<div id="pageTrans">

<div class="card">
  <div style="font-weight:900;">Menu</div>
  <div class="grid" id="menuGrid"></div>
</div>

<div class="card">
  <div style="font-weight:900;">Pesanan</div>
  <div id="cartList"></div>

  <div class="total">
    <div>Total</div>
    <div id="totalHarga">Rp 0</div>
  </div>

  <div class="total">
    <div>Item</div>
    <div id="totalItem">0</div>
  </div>
</div>

<div class="card">
  <div style="font-weight:900;">Pembayaran</div>

  <div class="payment-row">
    <button class="pay-btn" id="btnCash" onclick="setPayment('cash')">CASH</button>
    <button class="pay-btn" id="btnQris" onclick="setPayment('qris')">QRIS</button>
  </div>

  <input type="number" id="uangBayar" placeholder="Uang Bayar" oninput="calculateChange()">

  <div class="total">
    <div>Kembalian</div>
    <div id="kembalian">Rp 0</div>
  </div>
</div>

</div>

<div id="pageHist" class="hide">
  <div class="card">
    <div style="font-weight:900;">History</div>
    <div id="historyList"></div>
  </div>
</div>

</div>

<div class="footer">
  <button class="btn-danger" onclick="resetCart()">Reset</button>
  <button class="btn-main" onclick="completeTransaction()">Selesaikan</button>
</div>

<script>

const menus = [
  {name:"NASI AYAM", price:15000},
  {name:"NASI IKAN", price:13000},
  {name:"NASI TELUR", price:10000},
  {name:"BAKWAN", price:2000},
  {name:"AIR MINERAL", price:5000}
];

let cart = [];
let historyData = [];
let paymentMethod = "";
let currentTotal = 0;

/* ========== FORMAT ========= */

function formatRupiah(num){
  return "Rp " + num.toLocaleString("id-ID");
}

function cloneCart(data){
  return JSON.parse(JSON.stringify(data));
}

/* ========== MENU ========== */

function renderMenu(){
  const grid = document.getElementById("menuGrid");
  grid.innerHTML="";
  menus.forEach(m=>{
    const btn=document.createElement("button");
    btn.className="menu-btn";
    btn.innerHTML=`${m.name}<br><small>${formatRupiah(m.price)}</small>`;
    btn.onclick=()=>addToCart(m);
    grid.appendChild(btn);
  });
}

function addToCart(menu){
  const found=cart.find(i=>i.name===menu.name);
  if(found){found.qty++;}
  else{cart.push({...menu,qty:1});}
  updateCart();
}

function updateCart(){
  const list=document.getElementById("cartList");
  list.innerHTML="";
  let total=0;
  let items=0;

  cart.forEach((item,index)=>{
    total+=item.price*item.qty;
    items+=item.qty;

    const div=document.createElement("div");
    div.className="cart-item";
    div.innerHTML=`
      <div>${item.name} x${item.qty}</div>
      <div>
        ${formatRupiah(item.price*item.qty)}
        <button class="qty-btn" onclick="changeQty(${index},1)">+</button>
        <button class="qty-btn" onclick="changeQty(${index},-1)">-</button>
      </div>`;
    list.appendChild(div);
  });

  currentTotal = total;
  document.getElementById("totalHarga").textContent=formatRupiah(total);
  document.getElementById("totalItem").textContent=items;
  calculateChange();
}

function changeQty(index,delta){
  cart[index].qty+=delta;
  if(cart[index].qty<=0){cart.splice(index,1);}
  updateCart();
}

/* ========== PAYMENT ========== */

function setPayment(method){
  paymentMethod=method;
  document.getElementById("btnCash").classList.remove("active");
  document.getElementById("btnQris").classList.remove("active");
  if(method==="cash") document.getElementById("btnCash").classList.add("active");
  if(method==="qris") document.getElementById("btnQris").classList.add("active");
}

function calculateChange(){
  const bayar = Number(document.getElementById("uangBayar").value || 0);
  const change = bayar - currentTotal;
  document.getElementById("kembalian").textContent =
    change >= 0 ? formatRupiah(change) : "Rp 0";
}

/* ========== TRANSACTION ========== */

function completeTransaction(){

  const bayar = Number(document.getElementById("uangBayar").value || 0);

  if(cart.length===0){
    alert("Tidak ada pesanan");
    return;
  }

  if(!paymentMethod){
    alert("Pilih metode pembayaran");
    return;
  }

  if(bayar<currentTotal){
    alert("Uang kurang");
    return;
  }

  historyData.push({
    time:new Date().toLocaleString(),
    items:cloneCart(cart),
    total:currentTotal,
    bayar:bayar,
    change:bayar-currentTotal,
    method:paymentMethod
  });

  resetCart();
  renderHistory();
  alert("Transaksi berhasil");
}

function resetCart(){
  cart=[];
  currentTotal=0;
  paymentMethod="";
  document.getElementById("uangBayar").value="";
  document.getElementById("btnCash").classList.remove("active");
  document.getElementById("btnQris").classList.remove("active");
  updateCart();
}

/* ========== HISTORY ========== */

function renderHistory(){
  const list=document.getElementById("historyList");
  list.innerHTML="";
  historyData.slice().reverse().forEach(h=>{
    const div=document.createElement("div");
    div.className="cart-item";
    div.innerHTML=`
      <div>
        ${h.time}<br>
        ${h.items.map(i=>i.name+" x"+i.qty).join(", ")}
      </div>
      <div>${formatRupiah(h.total)}</div>
    `;
    list.appendChild(div);
  });
}

/* ========== TAB ========== */

function showTab(tab){
  document.getElementById("pageTrans").classList.add("hide");
  document.getElementById("pageHist").classList.add("hide");
  document.getElementById("tabTrans").classList.remove("active");
  document.getElementById("tabHist").classList.remove("active");

  if(tab==="trans"){
    document.getElementById("pageTrans").classList.remove("hide");
    document.getElementById("tabTrans").classList.add("active");
  }else{
    document.getElementById("pageHist").classList.remove("hide");
    document.getElementById("tabHist").classList.add("active");
  }
}

renderMenu();
updateCart();

</script>
</body>
</html>
