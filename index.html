<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kasir Digital</title>

<style>
body{
  font-family: Arial, sans-serif;
  background:#f5f5f5;
  margin:0;
  padding:10px;
}
.container{
  max-width:500px;
  margin:auto;
  background:white;
  padding:15px;
  border-radius:10px;
  box-shadow:0 0 10px rgba(0,0,0,0.1);
}
h2{
  text-align:center;
}
button{
  padding:8px;
  margin:4px 0;
  width:100%;
  border:none;
  border-radius:6px;
  background:#2e7d32;
  color:white;
  font-weight:bold;
}
button.secondary{
  background:#555;
}
.cart-item{
  display:flex;
  justify-content:space-between;
  margin:5px 0;
}
input{
  width:100%;
  padding:8px;
  margin:5px 0;
}
.total{
  font-size:18px;
  font-weight:bold;
  margin-top:10px;
}
</style>

</head>
<body>

<div class="container">
<h2>KASIR DIGITAL</h2>

<div id="menu"></div>

<h3>Keranjang</h3>
<div id="cart"></div>

<div class="total">
Total: Rp <span id="totalHarga">0</span>
</div>

<h3>Pembayaran</h3>
<input type="number" id="uangDibayar" placeholder="Masukkan nominal uang">
<button onclick="setUangPas()">Uang Pas</button>

<div class="total">
Kembalian: Rp <span id="kembalian">0</span>
</div>

<button onclick="selesaiTransaksi()">Selesai Transaksi</button>

<h3>History</h3>
<div id="history"></div>

</div>

<script>
const menus = [
  {name:"NASI KUNING AYAM", price:15000},
  {name:"NASI KUNING IKAN", price:13000},
  {name:"NASI KUNING TELUR", price:10000},
  {name:"NASI KUNING AYAM TELUR", price:22000},
  {name:"NASI KUNING IKAN TELUR", price:20000},
  {name:"IKAN", price:5000},
  {name:"BAKWAN", price:2000},
  {name:"NASI", price:5000},
  {name:"TELUR", price:5000},
  {name:"AYAM", price:5000},
  {name:"AIR MINERAL", price:5000},
];

let cart = [];
let historyData = [];
let totalHargaNumber = 0; // ðŸ”¥ FIX utama beda HP

function renderMenu(){
  const menuDiv = document.getElementById("menu");
  menuDiv.innerHTML = "";
  menus.forEach((m,index)=>{
    const btn = document.createElement("button");
    btn.innerText = m.name+" - Rp "+m.price.toLocaleString();
    btn.onclick = ()=> tambahKeCart(index);
    menuDiv.appendChild(btn);
  });
}

function tambahKeCart(index){
  const item = menus[index];
  const existing = cart.find(c=>c.name===item.name);
  if(existing){
    existing.qty++;
  }else{
    cart.push({...item, qty:1});
  }
  renderCart();
}

function renderCart(){
  const cartDiv = document.getElementById("cart");
  cartDiv.innerHTML = "";
  cart.forEach((item,i)=>{
    const div = document.createElement("div");
    div.className="cart-item";
    div.innerHTML = `
      <span>${item.name} x${item.qty}</span>
      <span>Rp ${(item.price*item.qty).toLocaleString()}</span>
    `;
    cartDiv.appendChild(div);
  });
  calculateTotal();
}

function calculateTotal(){
  let total = 0;
  cart.forEach(i=>{
    total += i.price * i.qty;
  });

  totalHargaNumber = total; // ðŸ”¥ gunakan angka asli
  document.getElementById("totalHarga").innerText = total.toLocaleString();
  calculateChange();
}

function calculateChange(){
  const uang = Number(document.getElementById("uangDibayar").value) || 0;
  const kembali = uang - totalHargaNumber; // ðŸ”¥ tidak ambil dari teks
  document.getElementById("kembalian").innerText =
    kembali > 0 ? kembali.toLocaleString() : 0;
}

function setUangPas(){
  document.getElementById("uangDibayar").value = totalHargaNumber;
  calculateChange();
}

function selesaiTransaksi(){
  if(cart.length===0) return;

  historyData.push({
    items:[...cart],
    total: totalHargaNumber
  });

  cart=[];
  document.getElementById("uangDibayar").value="";
  document.getElementById("kembalian").innerText="0";
  renderCart();
  renderHistory();
}

function renderHistory(){
  const div = document.getElementById("history");
  div.innerHTML="";
  historyData.forEach((h,i)=>{
    const d = document.createElement("div");
    d.innerHTML = `
      <strong>Transaksi ${i+1}</strong><br>
      Total: Rp ${h.total.toLocaleString()}
      <hr>
    `;
    div.appendChild(d);
  });
}

document.getElementById("uangDibayar")
  .addEventListener("input", calculateChange);

renderMenu();
renderCart();
</script>

</body>
</html>